<?xml version="1.0" encoding="UTF-8"?>

<!--
* Module Name : global-coordinator
* Version : 0.1-SNAPSHOT
*
* Software Name : HomeNap
* Version : 0.1-SNAPSHOT
*
* Copyright © 28/06/2012 – 28/06/2012 France Télécom
* This software is distributed under the Apache 2.0 license,
* the text of which is available at http://www.apache.org/licenses/LICENSE-2.0.html
* or see the "LICENSE-2.0.txt" file for more details.
*
* File Name   : metadata.xml
*
* Created     : 28/06/2012
* Author(s)   : Remi Druilhe
*
* Description :
*
-->

<ipojo xmlns:ev="org.apache.felix.ipojo.handlers.event">

    <!-- ============================================================== -->
    <!--                           Components                           -->
    <!-- ============================================================== -->

    <!-- Plan -->
    <component classname="com.orange.homenap.globalcoordinator.Plan" name="plan">
        <provides />

        <properties>
            <property field="stateful" mandatory="true" value="true"/>
            <property field="devices"/>
            <property field="services"/>
            <property field="resources"/>
        </properties>
    </component>

    <!-- Optimizer -->
    <component classname="com.orange.homenap.globalcoordinator.Optimizer" name="optimizer">
        <provides/>

        <requires field="controlPointManagerItf"/>
        <requires field="planItf" />
        <requires field="migraterItf" />

        <properties>
            <property field="stateful" mandatory="true" value="false"/>
        </properties>
    </component>

    <!-- Migrater -->
    <component classname="com.orange.homenap.globalcoordinator.Migrater" name="migrater">
        <provides/>

        <requires field="controlPointManagerItf"/>
        <requires field="planItf" />

        <properties>
            <property field="stateful" mandatory="true" value="false"/>
        </properties>
    </component>

    <!-- GCDevice -->
    <component classname="com.orange.homenap.globalcoordinator.GCDevice" name="gc-device">
        <provides/>

        <requires field="optimizerItf"/>
        <requires field="controlPointManagerItf"/>
        <requires field="planItf" />

        <callback transition="validate" method="start"/>
        <callback transition="invalidate" method="stop"/>

        <properties>
            <property field="stateful" mandatory="true" value="false"/>
        </properties>
    </component>

    <!-- ControlPointManager -->
    <component classname="com.orange.homenap.globalcoordinator.ControlPointManager" name="gc-control-point-manager">
        <provides/>

        <requires field="factory" filter="(factory.name=local-manager-control-point)"/>
        <requires field="planItf" />

        <callback transition="validate" method="start"/>

        <properties>
            <property field="stateful" mandatory="true" value="false"/>
        </properties>
    </component>

    <!-- LocalManagerControlPoint -->
    <component classname="com.orange.homenap.globalcoordinator.LocalManagerControlPoint" name="local-manager-control-point">
        <provides/>

        <callback transition="validate" method="start"/>
        <callback transition="invalidate" method="stop"/>

        <properties>
            <property field="udnLocalManager" mandatory="true"/>
            <property field="stateful" mandatory="true" value="false"/>
        </properties>
    </component>

    <!-- ============================================================== -->
    <!--                           Instances                            -->
    <!-- ============================================================== -->

    <instance component="plan">
        <property name="devices" type="list"/>
        <property name="services" type="list"/>
        <property name="resources" type="list"/>
    </instance>
    <instance component="optimizer"/>
    <instance component="migrater"/>
    <instance component="gc-control-point-manager"/>
    <instance component="gc-device"/>
</ipojo>